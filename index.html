<!DOCTYPE html>
<html lang="sv">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Snabbåtkomst Vårdverktyg</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <div class="container">

    <h1>Snabbåtkomst</h1>

    <!-- Riskbedömningar -->
    <div class="category" onclick="toggleContent('risk')">Riskbedömningar</div>
    <div id="risk" class="content">
      <form id="nortonForm">
        <h3>Modifierad Norton</h3>
        <label><input type="checkbox" name="norton" value="4"> Rörlighet: Går själv</label><br>
        <label><input type="checkbox" name="norton" value="3"> Rörlighet: Behöver hjälp</label><br>
        <label><input type="checkbox" name="norton" value="2"> Rörlighet: Begränsad</label><br>
        <label><input type="checkbox" name="norton" value="1"> Rörlighet: Immobiliserad</label><br>
        <button type="button" onclick="calculateNorton()">Beräkna Norton</button>
        <p id="nortonResult"></p>
      </form>
    </div>

    <!-- BMI -->
    <div class="category" onclick="toggleContent('bmi')">BMI Uträknare</div>
    <div id="bmi" class="content">
      <label>Vikt (kg): <input type="number" id="weight"></label><br>
      <label>Längd (cm): <input type="number" id="height"></label><br>
      <button onclick="calculateBMI()">Beräkna BMI</button>
      <p id="bmiResult"></p>
    </div>

    <!-- PM -->
    <div class="category" onclick="toggleContent('pm')">PM</div>
    <div id="pm" class="content">
      <ul>
        <li><a href="#">Pankreatit PM (placeholder)</a></li>
        <li><a href="#">Pre-OP Checklista (placeholder)</a></li>
      </ul>
    </div>

    <!-- Patientmodul -->
    <div class="category" onclick="toggleContent('patient')">Patientmodul</div>
    <div id="patient" class="content">
      <textarea id="patientNotes" placeholder="Skriv info om patienter här..." rows="8"></textarea><br>
      <button onclick="savePatientNotes()">Spara anteckning</button>
      <button onclick="clearPatientNotes()">Rensa nu</button>
    </div>

  </div>

  <script>
    // Toggle för dropdown
    function toggleContent(id) {
      const content = document.getElementById(id);
      content.classList.toggle("show");
    }

    // Norton kalkylator
    function calculateNorton() {
      const checkboxes = document.querySelectorAll('#nortonForm input[type="checkbox"]:checked');
      let score = 0;
      checkboxes.forEach(cb => score += parseInt(cb.value));
      document.getElementById("nortonResult").innerText = "Poäng: " + score;
    }

    // BMI kalkylator
    function calculateBMI() {
      const weight = parseFloat(document.getElementById("weight").value);
      const height = parseFloat(document.getElementById("height").value) / 100;
      if (weight > 0 && height > 0) {
        const bmi = (weight / (height * height)).toFixed(1);
        document.getElementById("bmiResult").innerText = "Ditt BMI är: " + bmi;
      }
    }

    // Patientmodul: Local Storage
    const notesBox = document.getElementById("patientNotes");
    const saved = localStorage.getItem("patientNotesData");
    const timestamp = localStorage.getItem("patientNotesTime");

    if (saved && timestamp && Date.now() - parseInt(timestamp) < 86400000) {
      notesBox.value = saved;
    }

    function savePatientNotes() {
      localStorage.setItem("patientNotesData", notesBox.value);
      localStorage.setItem("patientNotesTime", Date.now().toString());
      alert("Sparat!");
    }

    function clearPatientNotes() {
      localStorage.removeItem("patientNotesData");
      localStorage.removeItem("patientNotesTime");
      notesBox.value = "";
      alert("Rensat!");
    }
  </script>
</body>
</html>